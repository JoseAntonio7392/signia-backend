<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprende Lengua de Se√±as</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3.1640029074/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/hands.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils@0.3.1620248257/drawing_utils.js" crossorigin="anonymous"></script>
    <style>
        body {
            margin: 0;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #11357d, #4c2950);
            color: white;
            overflow-x: hidden;
        }
        #starfield {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background: #2d3748;
            padding: 2rem;
            border-radius: 0.5rem;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        .modal-content img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 1rem;
        }
        .modal-content input[type="text"] {
            width: 100%;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border-radius: 0.25rem;
            border: 1px solid #4a5568;
            background: #1a202c;
            color: white;
        }
        .modal-content input[type="file"] {
            margin-bottom: 1rem;
        }
        .video-container {
            position: relative;
            max-width: 640px;
            width: 100%;
            margin: 0 auto;
        }
        .video-container.hands-detected video {
            filter: brightness(1);
        }
        video, canvas {
            width: 100%;
            height: auto;
            border-radius: 0.5rem;
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
        }
        .status-text {
            font-size: 1.25rem;
            font-weight: 500;
        }
        .blink {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .error-message {
            color: #f56565;
            font-weight: bold;
        }
        .debug-text {
            font-size: 0.875rem;
            color: #a0aec0;
            white-space: pre-wrap;
        }
        .option-button {
            background: linear-gradient(to right, #a855f7, #ec4899);
            padding: 1rem 2rem;
            border-radius: 0.5rem;
            font-weight: bold;
            transition: transform 0.3s;
        }
        .option-button:hover {
            transform: scale(1.05);
        }
        .card {
            background: #2d3748;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .category-button {
            background: #4a5568;
            padding: 0.75rem;
            font-size: 1.1rem;
        }
        .carousel-container {
            position: relative;
            max-width: 100%;
            overflow: hidden;
        }
        .carousel {
            display: flex;
            transition: transform 0.5s ease;
        }
        .carousel-item {
            flex: 0 0 100%;
            text-align: center;
        }
        .carousel-item img {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem;
        }
        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
        }
        .carousel-nav.prev { left: 10px; }
        .carousel-nav.next { right: 10px; }
        .back-button {
            background: #4a5568;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: bold;
        }
        .user-button {
            background: linear-gradient(to right, #4c51bf, #667eea);
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: bold;
        }
        .combobox {
            background: #1a202c;
            color: white;
            padding: 0.5rem;
            border-radius: 0.25rem;
            border: 1px solid #4a5568;
        }
        .header-logo {
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
        }
        .animate-fade-in {
            animation: fadeIn 1s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    <div id="app"></div>
    <script>
        console.log('[DEBUG] Script started at ' + new Date().toLocaleString('en-US', { timeZone: 'America/Chicago' }));

        // Starfield and Moon animation
        const starfield = document.getElementById('starfield');
        const ctxStarfield = starfield.getContext('2d');
        let stars = [];
        let moon = { x: 100, y: 100, radius: 30, phase: 0, glow: 0 };

        function initStars() {
            starfield.width = window.innerWidth;
            starfield.height = window.innerHeight;
            stars = [];
            for (let i = 0; i < 100; i++) {
                stars.push({
                    x: Math.random() * starfield.width,
                    y: Math.random() * starfield.height,
                    radius: Math.random() * 2,
                    speed: Math.random() * 0.5 + 0.1
                });
            }
            moon.x = starfield.width * 0.2;
            moon.y = starfield.height * 0.2;
        }

        function animateStarsAndMoon() {
            ctxStarfield.clearRect(0, 0, starfield.width, starfield.height);
            ctxStarfield.fillStyle = 'white';
            stars.forEach(star => {
                ctxStarfield.beginPath();
                ctxStarfield.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctxStarfield.fill();
                star.y += star.speed;
                if (star.y > starfield.height) star.y = 0;
            });
            moon.phase += 0.01;
            moon.glow = 0.5 + Math.sin(moon.phase) * 0.2;
            ctxStarfield.beginPath();
            const gradient = ctxStarfield.createRadialGradient(
                moon.x, moon.y, moon.radius * 0.5,
                moon.x, moon.y, moon.radius * (1 + moon.glow)
            );
            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.9)');
            gradient.addColorStop(0.7, 'rgba(255, 255, 255, 0.4)');
            gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctxStarfield.fillStyle = gradient;
            ctxStarfield.arc(moon.x, moon.y, moon.radius, 0, Math.PI * 2);
            ctxStarfield.fill();
            ctxStarfield.fillStyle = 'rgba(200, 200, 200, 0.5)';
            ctxStarfield.beginPath();
            ctxStarfield.arc(moon.x - 10, moon.y - 5, 5, 0, Math.PI * 2);
            ctxStarfield.arc(moon.x + 8, moon.y + 5, 3, 0, Math.PI * 2);
            ctxStarfield.fill();
            moon.x += Math.sin(moon.phase * 0.5) * 0.2;
            moon.y += Math.cos(moon.phase * 0.5) * 0.1;
            requestAnimationFrame(animateStarsAndMoon);
        }

        window.addEventListener('resize', () => {
            initStars();
        });
        initStars();
        animateStarsAndMoon();

        const app = document.getElementById('app');
        let cameraInstance = null;
        let landmarkHistory = [];
        const HISTORY_SIZE = 15;
        let smoothedLandmarks = [];
        let currentVideo = null;
        let lastDetectedSign = null;
        let selectedVoice = null;
        let handsInstance = null;
        let lastFrameTime = 0;
        const TARGET_FPS = 60;
        const FRAME_INTERVAL = 1000 / TARGET_FPS;
        const INAPPROPRIATE_SIGNS = [
            'Groser√≠a (Tonto)', 'Groser√≠a (G√ºey)', 'Groser√≠a (Idiota)', 'Groser√≠a (Puto)',
            'Groser√≠a (Mierda)', 'Groser√≠a (Zorra)', 'Groser√≠a (Pendejo)', 'Groser√≠a (Verga)'
        ];
        let sePuedeDetectar = true;
        let ultimaSe√±a = null;
        let detectionHistory = [];
        const DETECTION_HISTORY_SIZE = 5;

        const SIGN_DEFINITIONS = [
            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
            'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',
            'almohada', 'azotea', 'az√∫carera', 'ba√±o', 'barrer', 'batidora', 'bote', 'buz√≥n',
            'cacerola', 'caj√≥n', 'cama', 'candelero', 'casa', 'cazuela', 'cepillo de dientes',
            'cepillo de pelo', 'champ√∫', 'charola', 'chup√≥n', 'cobertor', 'coladera', 'colcha',
            'colador', 'comal', 'comedor', 'c√≥moda', 'condominio', 'copa', 'corredor', 'corriente',
            'cortina', 'cuarto', 'cuchara', 'cuchillo', 'departamento', 'destapador',
            'antropolog√≠a', 'bandera', 'calificaci√≥n', 'campana', 'certificado', 'comp√°s',
            'computaci√≥n', 'cuaderno', 'dibujo', 'diccionario', 'escala', 'escuadra', 'escuela',
            'estudiante', 'goma', 'l√°piz', 'lecci√≥n', 'mapa', 'microscopio', 'papel', 'p√°rrafo',
            'perspectiva', 'pizarr√≥n', 'pluma', 'polit√©cnico', 'premio', 'preparatoria', 'primaria',
            'prueba', 'qu√≠mica', 'sacapuntas', 'secundaria', 'tecnol√≥gico',
            'enero', 'febrero', 'marzo', 'abril', 'mayo', 'junio', 'julio', 'agosto',
            'septiembre', 'octubre', 'noviembre', 'diciembre',
            'naranja', 'rojo', 'verde', 'rosa', 'blanco', 'negro', 'caf√©',
            'primavera', 'verano', 'oto√±o', 'invierno',
            'lunes', 'martes', 'mi√©rcoles', 'jueves', 'viernes', 's√°bado', 'domingo',
            'vaca', 'lobo', 'jirafa', 'tibur√≥n', 'perro', 'gato', 'puerco', 'rinoceronte',
            'serpiente', 'tigre', 'toro', 'lib√©lula', 'lagarto', 'gorila', 'foca',
            'Groser√≠a (Tonto)', 'Groser√≠a (G√ºey)', 'Groser√≠a (Idiota)', 'Groser√≠a (Puto)',
            'Groser√≠a (Mierda)', 'Groser√≠a (Zorra)', 'Groser√≠a (Pendejo)', 'Groser√≠a (Verga)',
            'saludo_hola', 'saludo_adios', 'saludo_como_estas', 'saludo_comparte', 'saludo_ayuda', 'saludo_buenos_dias',
            'familia', 'amigo', 'amor', 'trabajo', 'viaje', 'comida', 'agua', 'sol'
        ];

        const SIGN_TRANSLATIONS = {
            'A': 'A', 'B': 'B', 'C': 'C', 'D': 'D', 'E': 'E', 'F': 'F', 'G': 'G', 'H': 'H', 'I': 'I', 'J': 'J', 'K': 'K', 'L': 'L', 'M': 'M',
            'N': 'N', 'O': 'O', 'P': 'P', 'Q': 'Q', 'R': 'R', 'S': 'S', 'T': 'T', 'U': 'U', 'V': 'V', 'W': 'W', 'X': 'X', 'Y': 'Y', 'Z': 'Z',
            'almohada': 'Pillow', 'azotea': 'Rooftop', 'az√∫carera': 'Sugar Bowl', 'ba√±o': 'Bathroom', 'barrer': 'Sweep', 'batidora': 'Blender',
            'bote': 'Can', 'buz√≥n': 'Mailbox', 'cacerola': 'Saucepan', 'caj√≥n': 'Drawer', 'cama': 'Bed', 'candelero': 'Candleholder',
            'casa': 'House', 'cazuela': 'Casserole', 'cepillo de dientes': 'Toothbrush', 'cepillo de pelo': 'Hairbrush', 'champ√∫': 'Shampoo',
            'charola': 'Tray', 'chup√≥n': 'Pacifier', 'cobertor': 'Blanket', 'coladera': 'Drain', 'colcha': 'Quilt', 'colador': 'Strainer',
            'comal': 'Griddle', 'comedor': 'Dining Room', 'c√≥moda': 'Chest of Drawers', 'condominio': 'Condominium', 'copa': 'Glass',
            'corredor': 'Hallway', 'corriente': 'Current', 'cortina': 'Curtain', 'cuarto': 'Room', 'cuchara': 'Spoon', 'cuchillo': 'Knife',
            'departamento': 'Apartment', 'destapador': 'Bottle Opener', 'antropolog√≠a': 'Anthropology', 'bandera': 'Flag',
            'calificaci√≥n': 'Grade', 'campana': 'Bell', 'certificado': 'Certificate', 'comp√°s': 'Compass', 'computaci√≥n': 'Computing',
            'cuaderno': 'Notebook', 'dibujo': 'Drawing', 'diccionario': 'Dictionary', 'escala': 'Scale', 'escuadra': 'Square',
            'escuela': 'School', 'estudiante': 'Student', 'goma': 'Eraser', 'l√°piz': 'Pencil', 'lecci√≥n': 'Lesson', 'mapa': 'Map',
            'microscopio': 'Microscope', 'papel': 'Paper', 'p√°rrafo': 'Paragraph', 'perspectiva': 'Perspective', 'pizarr√≥n': 'Blackboard',
            'pluma': 'Pen', 'polit√©cnico': 'Polytechnic', 'premio': 'Prize', 'preparatoria': 'High School', 'primaria': 'Elementary School',
            'prueba': 'Test', 'qu√≠mica': 'Chemistry', 'sacapuntas': 'Sharpener', 'secundaria': 'Middle School', 'tecnol√≥gico': 'Technological',
            'enero': 'January', 'febrero': 'February', 'marzo': 'March', 'abril': 'April', 'mayo': 'May', 'junio': 'June', 'julio': 'July',
            'agosto': 'August', 'septiembre': 'September', 'octubre': 'October', 'noviembre': 'November', 'diciembre': 'December',
            'naranja': 'Orange', 'rojo': 'Red', 'verde': 'Green', 'rosa': 'Pink', 'blanco': 'White', 'negro': 'Black', 'caf√©': 'Brown',
            'primavera': 'Spring', 'verano': 'Summer', 'oto√±o': 'Autumn', 'invierno': 'Winter', 'lunes': 'Monday', 'martes': 'Tuesday',
            'mi√©rcoles': 'Wednesday', 'jueves': 'Thursday', 'viernes': 'Friday', 's√°bado': 'Saturday', 'domingo': 'Sunday',
            'vaca': 'Cow', 'lobo': 'Wolf', 'jirafa': 'Giraffe', 'tibur√≥n': 'Shark', 'perro': 'Dog', 'gato': 'Cat', 'puerco': 'Pig',
            'rinoceronte': 'Rhinoceros', 'serpiente': 'Snake', 'tigre': 'Tiger', 'toro': 'Bull', 'lib√©lula': 'Dragonfly', 'lagarto': 'Lizard',
            'gorila': 'Gorilla', 'foca': 'Seal', 'Groser√≠a (Tonto)': 'Insult (Fool)', 'Groser√≠a (G√ºey)': 'Insult (Dude)',
            'Groser√≠a (Idiota)': 'Insult (Idiot)', 'Groser√≠a (Puto)': 'Insult (Bastard)', 'Groser√≠a (Mierda)': 'Insult (Shit)',
            'Groser√≠a (Zorra)': 'Insult (Bitch)', 'Groser√≠a (Pendejo)': 'Insult (Asshole)', 'Groser√≠a (Verga)': 'Insult (Dick)',
            'saludo_hola': 'Hello', 'saludo_adios': 'Goodbye', 'saludo_como_estas': 'How are you', 'saludo_comparte': 'Share',
            'saludo_ayuda': 'Help', 'saludo_buenos_dias': 'Good morning', 'familia': 'Family', 'amigo': 'Friend', 'amor': 'Love',
            'trabajo': 'Work', 'viaje': 'Trip', 'comida': 'Food', 'agua': 'Water', 'sol': 'Sun'
        };

        function normalizeLandmarks(landmarks) {
            if (!landmarks || landmarks.length !== 21) {
                console.log('[DEBUG] Invalid landmarks array length:', landmarks ? landmarks.length : 'null');
                return Array(21).fill({ x: 0, y: 0, z: 0 });
            }
            return landmarks.map(lm => ({
                x: lm.x * 2 - 1,
                y: lm.y * 2 - 1,
                z: lm.z * 2 - 1
            }));
        }

        function smoothLandmarks(landmarks) {
            if (smoothedLandmarks.length === 0) {
                smoothedLandmarks = landmarks.map(lm => ({ x: lm.x, y: lm.y, z: lm.z }));
                return landmarks;
            }
            const SMOOTHER_FACTOR = 0.3;
            const smooth = landmarks.map((lm, i) => {
                const prev = smoothedLandmarks[i] || { x: lm.x, y: lm.y, z: lm.z };
                return {
                    x: prev.x + SMOOTHER_FACTOR * (lm.x - prev.x),
                    y: prev.y + SMOOTHER_FACTOR * (lm.y - prev.y),
                    z: prev.z + SMOOTHER_FACTOR * (lm.z - prev.z)
                };
            });
            smoothedLandmarks = smooth;
            return smooth;
        }

        function distanciaEuclidiana(a, b) {
            return Math.sqrt(
                Math.pow(a.x - b.x, 2) +
                Math.pow(a.y - b.y, 2) +
                Math.pow(a.z - b.z, 2)
            );
        }

        function estaDedoDoblado(tip, mcp, umbral = 0.04) {
            return distanciaEuclidiana(tip, mcp) < umbral;
        }

        function estaDedoExtendido(tip, mcp, umbral = 0.05) {
            return distanciaEuclidiana(tip, mcp) > umbral;
        }

        function detectLSMSign(landmarks) {
            if (!landmarks || landmarks.length !== 21) return null;

            const normalized = normalizeLandmarks(landmarks);
            const smoothed = smoothLandmarks(normalized);

            const THUMB_TIP = 4, THUMB_MCP = 2;
            const INDEX_TIP = 8, INDEX_MCP = 5;
            const MIDDLE_TIP = 12, MIDDLE_MCP = 9;
            const RING_TIP = 16, RING_MCP = 13;
            const PINKY_TIP = 20, PINKY_MCP = 17;
            const WRIST = 0;

            let debugSignInfo = [];

            // Letter A: Fist with thumb on side
            const isThumbAsideA = smoothed[THUMB_TIP].x > smoothed[INDEX_MCP].x + 0.02;
            const isIndexFoldedA = estaDedoDoblado(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleFoldedA = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedA = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedA = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            if (isThumbAsideA && isIndexFoldedA && isMiddleFoldedA && isRingFoldedA && isPinkyFoldedA) {
                debugSignInfo.push('Detected A');
                return 'A';
            } else {
                debugSignInfo.push(`A failed: ThumbAside=${isThumbAsideA}, IndexFolded=${isIndexFoldedA}, MiddleFolded=${isMiddleFoldedA}, RingFolded=${isRingFoldedA}, PinkyFolded=${isPinkyFoldedA}`);
            }

            // Letter B: All fingers extended, thumb folded across palm
            const isThumbFoldedB = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[PINKY_MCP]) < 0.10;
            const isIndexExtendedB = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedB = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingExtendedB = estaDedoExtendido(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyExtendedB = estaDedoExtendido(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            if (isThumbFoldedB && isIndexExtendedB && isMiddleExtendedB && isRingExtendedB && isPinkyExtendedB) {
                debugSignInfo.push('Detected B');
                return 'B';
            } else {
                debugSignInfo.push(`B failed: ThumbFolded=${isThumbFoldedB}, IndexExtended=${isIndexExtendedB}, MiddleExtended=${isMiddleExtendedB}, RingExtended=${isRingExtendedB}, PinkyExtended=${isPinkyExtendedB}`);
            }

            // Letter C: Fingers curved, thumb and fingers forming a C shape
            const thumbIndexDistC = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]);
            const isCFingerShape = thumbIndexDistC > 0.06 && thumbIndexDistC < 0.20;
            const isMiddleCurvedC = distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) > 0.03 && distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) < 0.10;
            if (isCFingerShape && isMiddleCurvedC) {
                debugSignInfo.push('Detected C');
                return 'C';
            } else {
                debugSignInfo.push(`C failed: CFingerShape=${isCFingerShape}, MiddleCurved=${isMiddleCurvedC}`);
            }

            // Letter D: Index extended, others folded, thumb touches middle
            const isIndexExtendedD = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleFoldedD = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedD = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedD = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isThumbTouchingMiddleD = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[MIDDLE_MCP]) < 0.06;
            if (isIndexExtendedD && isMiddleFoldedD && isRingFoldedD && isPinkyFoldedD && isThumbTouchingMiddleD) {
                debugSignInfo.push('Detected D');
                return 'D';
            } else {
                debugSignInfo.push(`D failed: IndexExtended=${isIndexExtendedD}, MiddleFolded=${isMiddleFoldedD}, RingFolded=${isRingFoldedD}, PinkyFolded=${isPinkyFoldedD}, ThumbTouchingMiddle=${isThumbTouchingMiddleD}`);
            }

            // Letter F: Index and thumb form a circle, others extended
            const isThumbIndexCircleF = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]) < 0.06;
            const isMiddleExtendedF = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingExtendedF = estaDedoExtendido(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyExtendedF = estaDedoExtendido(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            if (isThumbIndexCircleF && isMiddleExtendedF && isRingExtendedF && isPinkyExtendedF) {
                debugSignInfo.push('Detected F');
                return 'F';
            } else {
                debugSignInfo.push(`F failed: ThumbIndexCircle=${isThumbIndexCircleF}, MiddleExtended=${isMiddleExtendedF}, RingExtended=${isRingExtendedF}, PinkyExtended=${isPinkyExtendedF}`);
            }

            // Letter G: Index and thumb extended, others folded
            const isIndexExtendedG = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isThumbExtendedG = estaDedoExtendido(smoothed[THUMB_TIP], smoothed[THUMB_MCP]);
            const isMiddleFoldedG = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedG = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedG = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            if (isIndexExtendedG && isThumbExtendedG && isMiddleFoldedG && isRingFoldedG && isPinkyFoldedG) {
                debugSignInfo.push('Detected G');
                return 'G';
            } else {
                debugSignInfo.push(`G failed: IndexExtended=${isIndexExtendedG}, ThumbExtended=${isThumbExtendedG}, MiddleFolded=${isMiddleFoldedG}, RingFolded=${isRingFoldedG}, PinkyFolded=${isPinkyFoldedG}`);
            }

            // Letter H: Index and middle extended, others folded
            const isIndexExtendedH = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedH = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedH = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedH = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isThumbAsideH = smoothed[THUMB_TIP].x > smoothed[MIDDLE_MCP].x + 0.02;
            if (isIndexExtendedH && isMiddleExtendedH && isRingFoldedH && isPinkyFoldedH && isThumbAsideH) {
                debugSignInfo.push('Detected H');
                return 'H';
            } else {
                debugSignInfo.push(`H failed: IndexExtended=${isIndexExtendedH}, MiddleExtended=${isMiddleExtendedH}, RingFolded=${isRingFoldedH}, PinkyFolded=${isPinkyFoldedH}, ThumbAside=${isThumbAsideH}`);
            }

            // Hola: Open hand near face, palm facing inward
            const isHandOpenHola = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]) &&
                                   estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) &&
                                   estaDedoExtendido(smoothed[RING_TIP], smoothed[RING_MCP]) &&
                                   estaDedoExtendido(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmInwardHola = smoothed[THUMB_TIP].x < smoothed[PINKY_TIP].x;
            const isNearFaceHola = smoothed[WRIST].y < 0.2;
            if (isHandOpenHola && isPalmInwardHola && isNearFaceHola) {
                debugSignInfo.push('Detected Hola');
                return 'saludo_hola';
            } else {
                debugSignInfo.push(`Hola failed: HandOpen=${isHandOpenHola}, PalmInward=${isPalmInwardHola}, NearFace=${isNearFaceHola}, WristY=${smoothed[WRIST].y}`);
            }

            // Adi√≥s: Open hand, palm outward, fingers extended
            const isHandOpenAdios = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]) &&
                                    estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) &&
                                    estaDedoExtendido(smoothed[RING_TIP], smoothed[RING_MCP]) &&
                                    estaDedoExtendido(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmOutwardAdios = smoothed[THUMB_TIP].x > smoothed[PINKY_TIP].x;
            if (isHandOpenAdios && isPalmOutwardAdios) {
                debugSignInfo.push('Detected Adi√≥s');
                return 'saludo_adios';
            } else {
                debugSignInfo.push(`Adi√≥s failed: HandOpen=${isHandOpenAdios}, PalmOutward=${isPalmOutwardAdios}`);
            }

            // C√≥mo est√°s: Hand in C shape near chin
            const thumbIndexDistComoEstas = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]);
            const isCFingerShapeComoEstas = thumbIndexDistComoEstas > 0.06 && thumbIndexDistComoEstas < 0.20;
            const isMiddleCurvedComoEstas = distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) > 0.03 && distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) < 0.10;
            const isNearChinComoEstas = smoothed[WRIST].y < 0.1 && smoothed[WRIST].y > -0.3;
            if (isCFingerShapeComoEstas && isMiddleCurvedComoEstas && isNearChinComoEstas) {
                debugSignInfo.push('Detected C√≥mo est√°s');
                return 'saludo_como_estas';
            } else {
                debugSignInfo.push(`C√≥mo est√°s failed: CFingerShape=${isCFingerShapeComoEstas}, MiddleCurved=${isMiddleCurvedComoEstas}, NearChin=${isNearChinComoEstas}, WristY=${smoothed[WRIST].y}`);
            }

            // Comparte: V shape (index and middle extended), palm down
            const isIndexExtendedComparte = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedComparte = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedComparte = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedComparte = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmDownComparte = smoothed[INDEX_TIP].z > smoothed[WRIST].z;
            if (isIndexExtendedComparte && isMiddleExtendedComparte && isRingFoldedComparte && isPinkyFoldedComparte && isPalmDownComparte) {
                debugSignInfo.push('Detected Comparte');
                return 'saludo_comparte';
            } else {
                debugSignInfo.push(`Comparte failed: IndexExtended=${isIndexExtendedComparte}, MiddleExtended=${isMiddleExtendedComparte}, RingFolded=${isRingFoldedComparte}, PinkyFolded=${isPinkyFoldedComparte}, PalmDown=${isPalmDownComparte}`);
            }

            // Ayuda: A shape, palm up, near chest
            const isThumbAsideAyuda = smoothed[THUMB_TIP].x > smoothed[INDEX_MCP].x + 0.02;
            const isIndexFoldedAyuda = estaDedoDoblado(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleFoldedAyuda = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedAyuda = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedAyuda = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmUpAyuda = smoothed[INDEX_TIP].z < smoothed[WRIST].z;
            const isNearChestAyuda = smoothed[WRIST].y > -0.3 && smoothed[WRIST].y < 0.3;
            if (isThumbAsideAyuda && isIndexFoldedAyuda && isMiddleFoldedAyuda && isRingFoldedAyuda && isPinkyFoldedAyuda && isPalmUpAyuda && isNearChestAyuda) {
                debugSignInfo.push('Detected Ayuda');
                return 'saludo_ayuda';
            } else {
                debugSignInfo.push(`Ayuda failed: ThumbAside=${isThumbAsideAyuda}, IndexFolded=${isIndexFoldedAyuda}, MiddleFolded=${isMiddleFoldedAyuda}, RingFolded=${isRingFoldedAyuda}, PinkyFolded=${isPinkyFoldedAyuda}, PalmUp=${isPalmUpAyuda}, NearChest=${isNearChestAyuda}`);
            }

            // Buenos d√≠as: Both hands in B shape, near chest, palms facing outward
            const isLeftHandB = isThumbFoldedB && isIndexExtendedB && isMiddleExtendedB && isRingExtendedB && isPinkyExtendedB;
            const isRightHandB = isThumbFoldedB && isIndexExtendedB && isMiddleExtendedB && isRingExtendedB && isPinkyExtendedB;
            const isNearChestBuenosDias = smoothed[WRIST].y > -0.2 && smoothed[WRIST].y < 0.2;
            const isPalmOutwardBuenosDias = smoothed[THUMB_TIP].x > smoothed[PINKY_TIP].x;
            if (isLeftHandB && isRightHandB && isNearChestBuenosDias && isPalmOutwardBuenosDias) {
                debugSignInfo.push('Detected Buenos d√≠as');
                return 'saludo_buenos_dias';
            } else {
                debugSignInfo.push(`Buenos d√≠as failed: LeftHandB=${isLeftHandB}, RightHandB=${isRightHandB}, NearChest=${isNearChestBuenosDias}, PalmOutward=${isPalmOutwardBuenosDias}`);
            }

            // Familia: Both hands in F shape, crossed near chest
            const isThumbIndexCircleFamilia = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]) < 0.06;
            const isMiddleFoldedFamilia = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedFamilia = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedFamilia = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isCrossedFamilia = smoothed[THUMB_TIP].x < smoothed[INDEX_MCP].x - 0.1;
            const isNearChestFamilia = smoothed[WRIST].y > -0.3 && smoothed[WRIST].y < 0.3;
            if (isThumbIndexCircleFamilia && isMiddleFoldedFamilia && isRingFoldedFamilia && isPinkyFoldedFamilia && isCrossedFamilia && isNearChestFamilia) {
                debugSignInfo.push('Detected Familia');
                return 'familia';
            } else {
                debugSignInfo.push(`Familia failed: ThumbIndexCircle=${isThumbIndexCircleFamilia}, MiddleFolded=${isMiddleFoldedFamilia}, RingFolded=${isRingFoldedFamilia}, PinkyFolded=${isPinkyFoldedFamilia}, Crossed=${isCrossedFamilia}, NearChest=${isNearChestFamilia}`);
            }

            // Amigo: A shape, palm up, near shoulder
            const isThumbAsideAmigo = smoothed[THUMB_TIP].x > smoothed[INDEX_MCP].x + 0.02;
            const isIndexFoldedAmigo = estaDedoDoblado(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleFoldedAmigo = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedAmigo = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedAmigo = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmUpAmigo = smoothed[INDEX_TIP].z < smoothed[WRIST].z;
            const isNearShoulderAmigo = smoothed[WRIST].y < 0.1 && smoothed[WRIST].y > -0.1;
            if (isThumbAsideAmigo && isIndexFoldedAmigo && isMiddleFoldedAmigo && isRingFoldedAmigo && isPinkyFoldedAmigo && isPalmUpAmigo && isNearShoulderAmigo) {
                debugSignInfo.push('Detected Amigo');
                return 'amigo';
            } else {
                debugSignInfo.push(`Amigo failed: ThumbAside=${isThumbAsideAmigo}, IndexFolded=${isIndexFoldedAmigo}, MiddleFolded=${isMiddleFoldedAmigo}, RingFolded=${isRingFoldedAmigo}, PinkyFolded=${isPinkyFoldedAmigo}, PalmUp=${isPalmUpAmigo}, NearShoulder=${isNearShoulderAmigo}`);
            }

            // Amor: Crossed arms with both hands in A shape
            const isLeftThumbAsideAmor = smoothed[THUMB_TIP].x > smoothed[INDEX_MCP].x + 0.02;
            const isLeftIndexFoldedAmor = estaDedoDoblado(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isLeftMiddleFoldedAmor = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isLeftRingFoldedAmor = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isLeftPinkyFoldedAmor = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isRightThumbAsideAmor = smoothed[THUMB_TIP].x < smoothed[INDEX_MCP].x - 0.02;
            const isRightIndexFoldedAmor = estaDedoDoblado(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isRightMiddleFoldedAmor = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRightRingFoldedAmor = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isRightPinkyFoldedAmor = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            if (isLeftThumbAsideAmor && isLeftIndexFoldedAmor && isLeftMiddleFoldedAmor && isLeftRingFoldedAmor && isLeftPinkyFoldedAmor &&
                isRightThumbAsideAmor && isRightIndexFoldedAmor && isRightMiddleFoldedAmor && isRightRingFoldedAmor && isRightPinkyFoldedAmor) {
                debugSignInfo.push('Detected Amor');
                return 'amor';
            } else {
                debugSignInfo.push(`Amor failed: LeftThumbAside=${isLeftThumbAsideAmor}, LeftIndexFolded=${isLeftIndexFoldedAmor}, LeftMiddleFolded=${isLeftMiddleFoldedAmor}, LeftRingFolded=${isLeftRingFoldedAmor}, LeftPinkyFolded=${isLeftPinkyFoldedAmor}, RightThumbAside=${isRightThumbAsideAmor}, RightIndexFolded=${isRightIndexFoldedAmor}, RightMiddleFolded=${isRightMiddleFoldedAmor}, RightRingFolded=${isRightRingFoldedAmor}, RightPinkyFolded=${isRightPinkyFoldedAmor}`);
            }

            // Trabajo: W shape, palm down
            const isIndexExtendedTrabajo = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedTrabajo = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedTrabajo = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedTrabajo = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isThumbFoldedTrabajo = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[PINKY_MCP]) < 0.10;
            const isPalmDownTrabajo = smoothed[INDEX_TIP].z > smoothed[WRIST].z;
            if (isIndexExtendedTrabajo && isMiddleExtendedTrabajo && isRingFoldedTrabajo && isPinkyFoldedTrabajo && isThumbFoldedTrabajo && isPalmDownTrabajo) {
                debugSignInfo.push('Detected Trabajo');
                return 'trabajo';
            } else {
                debugSignInfo.push(`Trabajo failed: IndexExtended=${isIndexExtendedTrabajo}, MiddleExtended=${isMiddleExtendedTrabajo}, RingFolded=${isRingFoldedTrabajo}, PinkyFolded=${isPinkyFoldedTrabajo}, ThumbFolded=${isThumbFoldedTrabajo}, PalmDown=${isPalmDownTrabajo}`);
            }

            // Viaje: V shape, palm outward
            const isIndexExtendedViaje = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedViaje = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedViaje = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedViaje = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isThumbFoldedViaje = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[PINKY_MCP]) < 0.10;
            const isPalmOutwardViaje = smoothed[THUMB_TIP].x > smoothed[PINKY_TIP].x;
            if (isIndexExtendedViaje && isMiddleExtendedViaje && isRingFoldedViaje && isPinkyFoldedViaje && isThumbFoldedViaje && isPalmOutwardViaje) {
                debugSignInfo.push('Detected Viaje');
                return 'viaje';
            } else {
                debugSignInfo.push(`Viaje failed: IndexExtended=${isIndexExtendedViaje}, MiddleExtended=${isMiddleExtendedViaje}, RingFolded=${isRingFoldedViaje}, PinkyFolded=${isPinkyFoldedViaje}, ThumbFolded=${isThumbFoldedViaje}, PalmOutward=${isPalmOutwardViaje}`);
            }

            // Comida: C shape, near mouth
            const thumbIndexDistComida = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]);
            const isCFingerShapeComida = thumbIndexDistComida > 0.06 && thumbIndexDistComida < 0.20;
            const isMiddleCurvedComida = distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) > 0.03 && distanciaEuclidiana(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]) < 0.10;
            const isNearMouthComida = smoothed[WRIST].y < 0.1 && smoothed[WRIST].y > -0.2;
            if (isCFingerShapeComida && isMiddleCurvedComida && isNearMouthComida) {
                debugSignInfo.push('Detected Comida');
                return 'comida';
            } else {
                debugSignInfo.push(`Comida failed: CFingerShape=${isCFingerShapeComida}, MiddleCurved=${isMiddleCurvedComida}, NearMouth=${isNearMouthComida}`);
            }

            // Agua: W shape, palm up
            const isIndexExtendedAgua = estaDedoExtendido(smoothed[INDEX_TIP], smoothed[INDEX_MCP]);
            const isMiddleExtendedAgua = estaDedoExtendido(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedAgua = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedAgua = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isThumbFoldedAgua = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[PINKY_MCP]) < 0.10;
            const isPalmUpAgua = smoothed[INDEX_TIP].z < smoothed[WRIST].z;
            if (isIndexExtendedAgua && isMiddleExtendedAgua && isRingFoldedAgua && isPinkyFoldedAgua && isThumbFoldedAgua && isPalmUpAgua) {
                debugSignInfo.push('Detected Agua');
                return 'agua';
            } else {
                debugSignInfo.push(`Agua failed: IndexExtended=${isIndexExtendedAgua}, MiddleExtended=${isMiddleExtendedAgua}, RingFolded=${isRingFoldedAgua}, PinkyFolded=${isPinkyFoldedAgua}, ThumbFolded=${isThumbFoldedAgua}, PalmUp=${isPalmUpAgua}`);
            }

            // Sol: Circle with thumb and index, palm outward
            const isThumbIndexCircleSol = distanciaEuclidiana(smoothed[THUMB_TIP], smoothed[INDEX_TIP]) < 0.06;
            const isMiddleFoldedSol = estaDedoDoblado(smoothed[MIDDLE_TIP], smoothed[MIDDLE_MCP]);
            const isRingFoldedSol = estaDedoDoblado(smoothed[RING_TIP], smoothed[RING_MCP]);
            const isPinkyFoldedSol = estaDedoDoblado(smoothed[PINKY_TIP], smoothed[PINKY_MCP]);
            const isPalmOutwardSol = smoothed[THUMB_TIP].x > smoothed[PINKY_TIP].x;
            if (isThumbIndexCircleSol && isMiddleFoldedSol && isRingFoldedSol && isPinkyFoldedSol && isPalmOutwardSol) {
                debugSignInfo.push('Detected Sol');
                return 'sol';
            } else {
                debugSignInfo.push(`Sol failed: ThumbIndexCircle=${isThumbIndexCircleSol}, MiddleFolded=${isMiddleFoldedSol}, RingFolded=${isRingFoldedSol}, PinkyFolded=${isPinkyFoldedSol}, PalmOutward=${isPalmOutwardSol}`);
            }

            console.log('[DEBUG] Sign detection:\n' + debugSignInfo.join('\n'));
            return null;
        }

        function startCamera() {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            const status = document.getElementById('status');
            const gesture = document.getElementById('gesture');
            const canvasCtx = canvas.getContext('2d');

            handsInstance = new Hands({
                locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands@0.4.1646424915/${file}`
            });
            handsInstance.setOptions({
                maxNumHands: 2, modelComplexity: 0, minDetectionConfidence: 0.6, minTrackingConfidence: 0.6
            });

            handsInstance.onResults((results) => {
                canvasCtx.clearRect(0, 0, canvas.width, canvas.height);
                canvasCtx.drawImage(video, 0, 0, canvas.width, canvas.height);

                let detectedSign = null;
                if (results.multiHandLandmarks && results.multiHandedness) {
                    status.textContent = 'Manos detectadas';
                    for (let i = 0; i < results.multiHandLandmarks.length; i++) {
                        const landmarks = results.multiHandLandmarks[i];
                        drawConnectors(canvasCtx, landmarks, HAND_CONNECTIONS, { color: '#34d399', lineWidth: 5 });
                        drawLandmarks(canvasCtx, landmarks, { color: '#a855f7', lineWidth: 2 });
                        let sign = detectLSMSign(landmarks);
                        if (sign && sign.startsWith('saludo_')) sign = sign.replace('saludo_', '');
                        if (sign) detectedSign = sign;
                    }
                } else {
                    status.textContent = 'No se detectan manos';
                }

                if (detectedSign && detectedSign !== lastDetectedSign && sePuedeDetectar) {
                    if ('speechSynthesis' in window && selectedVoice) {
                        const utterance = new SpeechSynthesisUtterance(detectedSign === 'te_veo' ? 'te veo' : detectedSign === 'amigo' ? 'amigo' : detectedSign);
                        utterance.voice = selectedVoice;
                        utterance.lang = selectedVoice.lang || 'es-MX';
                        utterance.volume = 1.0;
                        utterance.rate = 1.0;
                        utterance.pitch = 1.0;
                        utterance.onend = () => { sePuedeDetectar = true; };
                        speechSynthesis.cancel();
                        sePuedeDetectar = false;
                        speechSynthesis.speak(utterance);
                    } else if ('speechSynthesis' in window && !selectedVoice) {
                        const utterance = new SpeechSynthesisUtterance(detectedSign === 'te_veo' ? 'te veo' : detectedSign === 'amigo' ? 'amigo' : detectedSign);
                        const voices = speechSynthesis.getVoices();
                        const defaultVoice = voices.find(v => v.lang.startsWith('es-')) || voices[0];
                        if (defaultVoice) {
                            utterance.voice = defaultVoice;
                            utterance.lang = defaultVoice.lang || 'es-MX';
                            utterance.volume = 1.0;
                            utterance.rate = 1.0;
                            utterance.pitch = 1.0;
                            utterance.onend = () => { sePuedeDetectar = true; };
                            speechSynthesis.cancel();
                            sePuedeDetectar = false;
                            speechSynthesis.speak(utterance);
                        }
                    }
                    lastDetectedSign = detectedSign;
                    gesture.innerHTML = `Se√±a detectada: ${detectedSign} <br> Traducci√≥n: ${SIGN_TRANSLATIONS[detectedSign] || 'No disponible'}`;
                    setTimeout(() => { sePuedeDetectar = true; }, 1000);
                } else if (!detectedSign) {
                    gesture.innerHTML = 'Se√±a detectada: Ninguna <br> Traducci√≥n: -';
                }
            });

            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user', width: 640, height: 480 } }).then(stream => {
                video.srcObject = stream;
                video.play();
                video.onloadedmetadata = () => {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    cameraInstance = new Camera(video, {
                        onFrame: async () => await handsInstance.send({ image: video }),
                        width: video.videoWidth, height: video.videoHeight
                    });
                    cameraInstance.start();
                    status.textContent = 'C√°mara iniciada';
                    if ('speechSynthesis' in window) {
                        const utterance = new SpeechSynthesisUtterance('Iniciando');
                        utterance.volume = 0;
                        speechSynthesis.speak(utterance);
                    }
                };
            });
        }

        function stopCamera() {
            if (cameraInstance) cameraInstance.stop();
            if (currentVideo && currentVideo.srcObject) {
                currentVideo.srcObject.getTracks().forEach(track => track.stop());
                currentVideo.srcObject = null;
            }
            if (handsInstance) handsInstance.close();
            lastDetectedSign = null;
            sePuedeDetectar = true;
        }

        function clearScreen() {
            app.innerHTML = '';
            stopCamera();
            currentVideo = null;
            console.log('[DEBUG] Screen cleared');
        }

        function renderMainScreen() {
            clearScreen();
            app.innerHTML = `
                <div class="relative min-h-screen flex flex-col items-center justify-center text-white text-center px-4 animate-fade-in">
                    <button class="user-button absolute top-4 right-4" id="userButton">Usuario</button>
                    <img src="assets/img/logo.jpg" alt="Logo" class="header-logo w-24 h-24 md:w-28 md:h-28 mb-6" />
                    <h1 class="text-4xl md:text-5xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-pink-600 mb-10 drop-shadow-lg">
                        Aprende Lengua de Se√±as
                    </h1>
                    <div class="flex flex-col md:flex-row gap-6">
                        <button id="btnTraduccion" class="option-button text-xl">
                            üî§ Traducci√≥n
                        </button>
                        <button id="btnAprendizaje" class="option-button text-xl">
                            üìö Aprendizaje
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('btnTraduccion').addEventListener('click', renderTraduccionScreen);
            document.getElementById('btnAprendizaje').addEventListener('click', renderAprendizajeScreen);
            document.getElementById('userButton').addEventListener('click', renderUserScreen);
            console.log('[DEBUG] Main screen rendered');
        }

        function renderUserScreen() {
            const userName = localStorage.getItem('userName') || 'Usuario Ejemplo';
            const profilePicture = localStorage.getItem('profilePicture') || 'https://via.placeholder.com/100?text=User';
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <img src="${profilePicture}" alt="User Profile" id="profilePicture" />
                    <input type="text" id="userNameInput" value="${userName}" placeholder="Ingresa tu nombre" />
                    <input type="file" id="profilePictureInput" accept="image/*" />
                    <button class="back-button mt-4" id="saveUserProfile">Guardar</button>
                    <button class="back-button mt-2" id="closeUserModal">Cerrar</button>
                </div>
            `;
            document.body.appendChild(modal);

            const userNameInput = document.getElementById('userNameInput');
            const profilePictureInput = document.getElementById('profilePictureInput');
            const profilePictureImg = document.getElementById('profilePicture');

            profilePictureInput.addEventListener('change', () => {
                const file = profilePictureInput.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        profilePictureImg.src = e.target.result;
                        localStorage.setItem('profilePicture', e.target.result);
                        console.log('[DEBUG] Profile picture updated');
                    };
                    reader.readAsDataURL(file);
                }
            });

            document.getElementById('saveUserProfile').addEventListener('click', () => {
                const newName = userNameInput.value.trim();
                if (newName) {
                    localStorage.setItem('userName', newName);
                    console.log('[DEBUG] User name saved: ' + newName);
                }
            });

            document.getElementById('closeUserModal').addEventListener('click', () => {
                modal.remove();
                console.log('[DEBUG] User modal closed');
            });

            console.log('[DEBUG] User screen rendered');
        }

        function renderTraduccionScreen() {
            clearScreen();
            app.innerHTML = `
                <div class="relative min-h-screen flex flex-col items-center justify-center">
                    <button class="user-button absolute top-4 right-4" id="userButton">Usuario</button>
                    <button class="back-button absolute top-4 left-4" id="backToMenu">‚Üê Volver</button>
                    <h2 class="text-3xl font-semibold text-center mb-6">Traducci√≥n en Tiempo Real</h2>
                    <div id="videoContainer" class="video-container">
                        <video id="video" autoplay playsinline></video>
                        <canvas id="canvas"></canvas>
                    </div>
                    <div class="text-center mt-6">
                        <label for="voiceSelect" class="text-lg">Seleccionar voz:</label>
                        <select id="voiceSelect" class="combobox mt-2">
                            <option value="" disabled selected>Elige una voz</option>
                        </select>
                        <p id="status" class="status-text mt-4">Iniciando c√°mara...</p>
                        <p id="gesture" class="status-text mt-2">Se√±a detectada: Ninguna <br> Traducci√≥n: -</p>
                        <div id="errorMessage" class="error-message hidden mt-4"></div>
                        <div id="debugMessage" class="debug-text hidden mt-4"></div>
                    </div>
                </div>
            `;
            document.getElementById('backToMenu').addEventListener('click', renderMainScreen);
            document.getElementById('userButton').addEventListener('click', renderUserScreen);
            populateVoiceSelect();
            startCamera();
            console.log('[DEBUG] Traducci√≥n screen rendered');
        }

        function populateVoiceSelect() {
            const voiceSelect = document.getElementById('voiceSelect');
            const errorMessage = document.getElementById('errorMessage');
            if (!voiceSelect) return;

            const updateVoices = () => {
                const voices = speechSynthesis.getVoices();
                voiceSelect.innerHTML = '<option value="" disabled selected>Elige una voz</option>';
                if (voices.length === 0) {
                    voiceSelect.innerHTML += '<option value="" disabled>No hay voces disponibles</option>';
                    console.warn('[DEBUG] No voices available');
                    if (errorMessage) {
                        errorMessage.textContent = 'No se encontraron voces disponibles. Intenta en otro navegador.';
                        errorMessage.classList.remove('hidden');
                    }
                    return;
                }
                const spanishVoices = voices.filter(v => v.lang.startsWith('es-'));
                const otherVoices = voices.filter(v => !v.lang.startsWith('es-'));
                [...spanishVoices, ...otherVoices].forEach((voice, index) => {
                    const option = document.createElement('option');
                    option.value = index;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    voiceSelect.appendChild(option);
                });
                if (spanishVoices.length > 0) {
                    selectedVoice = spanishVoices.find(v => v.lang === 'es-MX') || spanishVoices[0];
                    voiceSelect.value = voices.indexOf(selectedVoice);
                    console.log('[DEBUG] Default Spanish voice selected: ' + selectedVoice.name);
                } else if (voices.length > 0) {
                    selectedVoice = voices[0];
                    voiceSelect.value = 0;
                    console.log('[DEBUG] Default non-Spanish voice selected: ' + selectedVoice.name);
                }
            };

            if ('speechSynthesis' in window) {
                if (speechSynthesis.getVoices().length > 0) {
                    updateVoices();
                } else {
                    speechSynthesis.onvoiceschanged = updateVoices;
                    setTimeout(updateVoices, 1000);
                }
            } else {
                console.warn('[DEBUG] SpeechSynthesis not supported');
                if (errorMessage) {
                    errorMessage.textContent = 'S√≠ntesis de voz no soportada en este navegador.';
                    errorMessage.classList.remove('hidden');
                }
            }

            voiceSelect.addEventListener('change', () => {
                const voices = speechSynthesis.getVoices();
                selectedVoice = voices[voiceSelect.value] || null;
                console.log(`[DEBUG] Voice selected: ${selectedVoice ? selectedVoice.name : 'None'}`);
            });
        }

        function renderAprendizajeScreen() {
            clearScreen();
            app.innerHTML = `
                <div class="relative min-h-screen flex flex-col items-center justify-center">
                    <button class="user-button absolute top-4 right-4" id="userButton">Usuario</button>
                    <button class="back-button absolute top-4 left-4" id="backToMenu2">‚Üê Volver</button>
                    <h2 class="text-3xl font-semibold text-center mb-6">M√≥dulo de Aprendizaje</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <button id="videoButton" class="card p-6 text-center">V√≠deos</button>
                        <button id="imageButton" class="card p-6 text-center">Im√°genes</button>
                    </div>
                    <div id="contentContainer" class="mt-6"></div>
                </div>
            `;
            document.getElementById('backToMenu2').addEventListener('click', renderMainScreen);
            document.getElementById('userButton').addEventListener('click', renderUserScreen);
            document.getElementById('videoButton').addEventListener('click', () => showCategories('videos'));
            document.getElementById('imageButton').addEventListener('click', () => showCategories('images'));
            console.log('[DEBUG] Aprendizaje screen rendered');
        }

        function showCategories(type) {
            const contentContainer = document.getElementById('contentContainer');
            contentContainer.innerHTML = `<div class="debug-text">Cargando categor√≠as de ${type}...</div>`;

            const subfolders = [
                'abecedario', 'animales', 'casa', 'colores', 'comida', 'cuerpo', 'diasdesemana',
                'escuela', 'estaciones', 'meses', 'tiempo', 'saludos', 'groserias'
            ];
            contentContainer.innerHTML = `
                <h3 class="text-2xl font-semibold mb-4">Categor√≠as de ${type.charAt(0).toUpperCase() + type.slice(1)}</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${subfolders.map(folder => `
                        <button class="category-button card p-3 text-center" data-type="${type}" data-folder="${folder}">
                            ${folder.charAt(0).toUpperCase() + folder.slice(1)}
                        </button>
                    `).join('')}
                </div>
            `;

            document.querySelectorAll('.category-button').forEach(button => {
                button.addEventListener('click', () => {
                    const type = button.dataset.type;
                    const folder = button.dataset.folder;
                    if (type === 'videos') showVideos(folder);
                    else showImages(folder);
                });
            });
            console.log('[DEBUG] Categories loaded: ' + type);
        }

        function showVideos(folder) {
            const contentContainer = document.getElementById('contentContainer');
            const videoFiles = [
                { name: 'Video 1', path: `/LENGUAJE-DE-SENAS/assets/videos/${folder}/Video1.mp4` },
                { name: 'Video 2', path: `/LENGUAJE-DE-SENAS/${folder}/${folder}/videos/Video2.mp4` },
                { name: 'Video 3', path: `/Videos/${folder}/Video3.mp4` },
                { name: 'Videos 4', path: '/LENGUAJE-DE-SENAS/**/${folder}/Video4.mp4' }
            ];

            contentContainer.innerHTML = `
                <h3 class="text-2xl font-semibold mb-4">${folder.charAt(0).toUpperCase() + folder.slice(1)}</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    ${videoFiles.map(video => `
                        <div class="card p-4 text-center">
                            <video controls preload="metadata" class="w-full max-w-md rounded-lg">
                                <source src="${video.path}" type="video/mp4">
                                Tu navegador no soporta el elemento de video.
                            </video>
                            <p class="mt-2">V√≠deo: ${video.name} - ${folder}</p>
                        </div>
                    `).join('')}
                </div>
            `;

            contentContainer.querySelectorAll('video').forEach(video => {
                video.onloadeddata = () => console.log('[DEBUG] Video loaded: ' + video.querySelector('source').src);
                video.onerror = () => {
                    console.error('[ERROR] Video failed to load: ' + video.querySelector('source').src);
                    video.parentElement.innerHTML += '<div class="error-message">No se pudo cargar el video.</div>';
                };
            });

            console.log('[DEBUG] Videos loaded for: ' + folder);
        }

        function showImages(folder) {
            const contentContainer = document.getElementById('contentContainer');
            contentContainer.innerHTML = '<div class="debug-text">Cargando im√°genes...</div>';
            const images = fetchImages(folder);
            contentContainer.innerHTML = `
                <h3 class="text-2xl font-semibold mb-4">${folder.charAt(0).toUpperCase() + folder.slice(1)}</h3>
                ${images.length === 0 ? '<div class="error-message">No hay im√°genes en esta categor√≠a.</div>' : `
                    <div class="carousel-container">
                        <div class="carousel" id="carousel">
                            ${images.map(img => `
                                <div class="carousel-item">
                                    <img src="${img.path}" alt="${img.name}">
                                    <p class="mt-2">${img.name}</p>
                                </div>
                            `).join('')}
                        </div>
                        <button class="carousel-nav prev" onclick="moveCarousel(-1)">‚Üê</button>
                        <button class="carousel-nav next" onclick="moveCarousel(1)">‚Üí</button>
                    </div>
                `}
            `;
            contentContainer.querySelectorAll('img').forEach(img => {
                img.onload = () => console.log('[DEBUG] Image loaded: ' + img.src);
                img.onerror = () => {
                    console.error('[ERROR] Image failed to load: ' + img.src);
                    img.parentElement.innerHTML += '<div class="error-message">No se pudo cargar la imagen.</div>';
                };
            });
            initializeCarousel();
            console.log('[DEBUG] Images loaded for: ' + folder);
        }

        function fetchImages(folder) {
            const basePath = `assets/img/${folder}/`;
            const images = {
                abecedario: [
                    { name: 'Letra A', path: `${basePath}letra_A.jpg` },
                    { name: 'Letra B', path: `${basePath}letra_B.jpg` },
                    { name: 'Letra C', path: `${basePath}letra_C.jpg` },
                    { name: 'Letra D', path: `${basePath}letra_D.jpg` },
                    { name: 'Letra E', path: `${basePath}letra_E.jpg` },
                    { name: 'Letra F', path: `${basePath}letra_F.jpg` },
                    { name: 'Letra G', path: `${basePath}letra_G.jpg` },
                    { name: 'Letra H', path: `${basePath}letra_H.jpg` },
                    { name: 'Letra I', path: `${basePath}letra_I.jpg` },
                    { name: 'Letra J', path: `${basePath}letra_J.jpg` },
                    { name: 'Letra K', path: `${basePath}letra_K.jpg` },
                    { name: 'Letra L', path: `${basePath}letra_L.jpg` },
                    { name: 'Letra M', path: `${basePath}letra_M.jpg` },
                    { name: 'Letra N', path: `${basePath}letra_N.jpg` },
                    { name: 'Letra O', path: `${basePath}letra_O.jpg` },
                    { name: 'Letra P', path: `${basePath}letra_P.jpg` },
                    { name: 'Letra Q', path: `${basePath}letra_Q.jpg` },
                    { name: 'Letra R', path: `${basePath}letra_R.jpg` },
                    { name: 'Letra S', path: `${basePath}letra_S.jpg` },
                    { name: 'Letra T', path: `${basePath}letra_T.jpg` },
                    { name: 'Letra U', path: `${basePath}letra_U.jpg` },
                    { name: 'Letra V', path: `${basePath}letra_V.jpg` },
                    { name: 'Letra W', path: `${basePath}letra_W.jpg` },
                    { name: 'Letra X', path: `${basePath}letra_X.jpg` },
                    { name: 'Letra Y', path: `${basePath}letra_Y.jpg` },
                    { name: 'Letra Z', path: `${basePath}letra_Z.jpg` }
                ],
                animales: [
                    { name: 'animal_leon.jpg', path: `${basePath}animal_leon.jpg` },
                    { name: 'animal_ballena.jpg', path: `${basePath}animal_ballena.jpg` },
                    { name: 'animal_caballo.jpg', path: `${basePath}animal_caballo.jpg` },
                    { name: 'animal_cebra.jpg', path: `${basePath}animal_cebra.jpg` },
                    { name: 'animal_elefante.jpg', path: `${basePath}animal_elefante.jpg` },
                    { name: 'animal_foca.jpg', path: `${basePath}animal_foca.jpg` },
                    { name: 'animal_gorila.jpg', path: `${basePath}animal_gorila.jpg` },
                    { name: 'animal_jirafa.jpg', path: `${basePath}animal_jirafa.jpg` },
                    { name: 'animal_lagarto.jpg', path: `${basePath}animal_lagarto.jpg` },
                    { name: 'animal_lobo.jpg', path: `${basePath}animal_lobo.jpg` },
                    { name: 'animal_puerco.jpg', path: `${basePath}animal_puerco.jpg` },
                    { name: 'animal_serpiente.jpg', path: `${basePath}animal_serpiente.jpg` },
                    { name: 'animal_tigre.jpg', path: `${basePath}animal_tigre.jpg` },
                    { name: 'animal_vaca.jpg', path: `${basePath}animal_vaca.jpg` },
                    { name: 'animal_pavo_real.jpg', path: `${basePath}animal_pavo_real.jpg` }
                ],
                casa: [
                    { name: 'Captura de pantalla 2025-04-110 122451.png', path: `${basePath}Captura de pantalla 2025-04-110 122451.png` },
                    { name: 'Captura de pantalla 2025-04-110 122458.png', path: `${basePath}Captura de pantalla 2025-04-110 122458.png` },
                    { name: 'Captura de pantalla 2025-04-110 122503.png', path: `${basePath}Captura de pantalla 2025-04-110 122503.png` },
                    { name: 'Captura de pantalla 2025-04-110 122507.png', path: `${basePath}Captura de pantalla 2025-04-110 122507.png` },
                    { name: 'Captura de pantalla 2025-04-110 122511.png', path: `${basePath}Captura de pantalla 2025-04-110 122511.png` },
                    { name: 'Captura de pantalla 2025-04-110 122518.png', path: `${basePath}Captura de pantalla 2025-04-110 122518.png` },
                    { name: 'Captura de pantalla 2025-04-110 122523.png', path: `${basePath}Captura de pantalla 2025-04-110 122523.png` },
                    { name: 'Captura de pantalla 2025-04-110 122534.png', path: `${basePath}Captura de pantalla 2025-04-110 122534.png` },
                    { name: 'Captura de pantalla 2025-04-110 122541.png', path: `${basePath}Captura de pantalla 2025-04-110 122541.png` },
                    { name: 'Captura de pantalla 2025-04-110 122545.png', path: `${basePath}Captura de pantalla 2025-04-110 122545.png` },
                    { name: 'Captura de pantalla 2025-04-110 122549.png', path: `${basePath}Captura de pantalla 2025-04-110 122549.png` },
                    { name: 'Captura de pantalla 2025-04-110 122553.png', path: `${basePath}Captura de pantalla 2025-04-110 122553.png` },
                    { name: 'Captura de pantalla 2025-04-110 122557.png', path: `${basePath}Captura de pantalla 2025-04-110 122557.png` },
                    { name: 'Captura de pantalla 2025-04-110 122601.png', path: `${basePath}Captura de pantalla 2025-04-110 122601.png` },
                    { name: 'Captura de pantalla 2025-04-110 122608.png', path: `${basePath}Captura de pantalla 2025-04-110 122608.png` },
                    { name: 'Captura de pantalla 2025-04-110 122619.png', path: `${basePath}Captura de pantalla 2025-04-110 122619.png` },
                    { name: 'Captura de pantalla 2025-04-110 122623.png', path: `${basePath}Captura de pantalla 2025-04-110 122623.png` },
                    { name: 'Captura de pantalla 2025-04-110 122627.png', path: `${basePath}Captura de pantalla 2025-04-110 122627.png` },
                    { name: 'Captura de pantalla 2025-04-110 122631.png', path: `${basePath}Captura de pantalla 2025-04-110 122631.png` },
                    { name: 'Captura de pantalla 2025-04-110 122637.png', path: `${basePath}Captura de pantalla 2025-04-110 122637.png` },
                    { name: 'Captura de pantalla 2025-04-110 122640.png', path: `${basePath}Captura de pantalla 2025-04-110 122640.png` },
                    { name: 'Captura de pantalla 2025-04-110 122644.png', path: `${basePath}Captura de pantalla 2025-04-110 122644.png` },
                    { name: 'Captura de pantalla 2025-04-110 122648.png', path: `${basePath}Captura de pantalla 2025-04-110 122648.png` },
                    { name: 'Captura de pantalla 2025-04-110 122652.png', path: `${basePath}Captura de pantalla 2025-04-110 122652.png` },
                    { name: 'Captura de pantalla 2025-04-110 122659.png', path: `${basePath}Captura de pantalla 2025-04-110 122659.png` },
                    { name: 'Captura de pantalla 2025-04-110 122703.png', path: `${basePath}Captura de pantalla 2025-04-110 122703.png` },
                    { name: 'Captura de pantalla 2025-04-110 122706.png', path: `${basePath}Captura de pantalla 2025-04-110 122706.png` },
                    { name: 'Captura de pantalla 2025-04-110 122710.png', path: `${basePath}Captura de pantalla 2025-04-110 122710.png` },
                    { name: 'Captura de pantalla 2025-04-110 122715.png', path: `${basePath}Captura de pantalla 2025-04-110 122715.png` },
                    { name: 'Captura de pantalla 2025-04-110 122719.png', path: `${basePath}Captura de pantalla 2025-04-110 122719.png` },
                    { name: 'Captura de pantalla 2025-04-110 122726.png', path: `${basePath}Captura de pantalla 2025-04-110 122726.png` },
                    { name: 'Captura de pantalla 2025-04-110 122730.png', path: `${basePath}Captura de pantalla 2025-04-110 122730.png` },
                    { name: 'Captura de pantalla 2025-04-110 122734.png', path: `${basePath}Captura de pantalla 2025-04-110 122734.png` },
                    { name: 'Captura de pantalla 2025-04-110 122739.png', path: `${basePath}Captura de pantalla 2025-04-110 122739.png` },
                    
                ],
                colores: [
                    { name: 'Naranja', path: `${basePath}naranja.jpg` },
                    { name: 'Rojo', path: `${basePath}rojo.jpg` },
                    { name: 'Verde', path: `${basePath}verde.jpg` },
                    { name: 'Rosa', path: `${basePath}rosa.jpg` },
                    { name: 'Blanco', path: `${basePath}blanco.jpg` },
                    { name: 'Negro', path: `${basePath}negro.jpg` },
                    { name: 'Caf√©', path: `${basePath}cafe.jpg` }
                ],
                comida: [
                    { name: 'Comida 1', path: `${basePath}comida_1.jpg` },
                    { name: 'Comida 2', path: `${basePath}comida_2.jpg` },
                ],
                cuerpo: [
                    { name: 'Mano', path: `${basePath}cuerpo_mano.jpg` },
                    { name: 'Pie', path: `${basePath}cuerpo_pie.jpg` },
                    { name: 'Cabeza', path: `${basePath}cuerpo_cabeza.jpg` },
                    { name: 'Brazo', path: `${basePath}cuerpo_brazo.jpg` },
                    { name: 'Pierna', path: `${basePath}cuerpo_pierna.jpg` }
                ],
                diasdesemana: [
                    { name: 'Lunes', path: `${basePath}lunes.jpg` },
                    { name: 'Martes', path: `${basePath}martes.jpg` },
                    { name: 'Mi√©rcoles', path: `${basePath}miercoles.jpg` },
                    { name: 'Jueves', path: `${basePath}jueves.jpg` },
                    { name: 'Viernes', path: `${basePath}viernes.jpg` },
                    { name: 'S√°bado', path: `${basePath}sabado.jpg` },
                    { name: 'Domingo', path: `${basePath}domingo.jpg` }
                ],
                escuela: [
                    { name: 'Antropolog√≠a', path: `${basePath}antropologia.jpg` },
                    { name: 'Bandera', path: `${basePath}bandera.jpg` },
                    { name: 'Calificaci√≥n', path: `${basePath}calificacion.jpg` },
                    { name: 'Campana', path: `${basePath}campana.jpg` },
                    { name: 'Certificado', path: `${basePath}certificado.jpg` },
                    { name: 'Comp√°s', path: `${basePath}compas.jpg` },
                    { name: 'Computaci√≥n', path: `${basePath}computacion.jpg` },
                    { name: 'Cuaderno', path: `${basePath}cuaderno.jpg` },
                    { name: 'Dibujo', path: `${basePath}dibujo.jpg` },
                    { name: 'Diccionario', path: `${basePath}diccionario.jpg` },
                    { name: 'Escala', path: `${basePath}escala.jpg` },
                    { name: 'Escuadra', path: `${basePath}escuadra.jpg` },
                    { name: 'Escuela', path: `${basePath}escuela.jpg` },
                    { name: 'Estudiante', path: `${basePath}estudiante.jpg` },
                    { name: 'Goma', path: `${basePath}goma.jpg` },
                    { name: 'L√°piz', path: `${basePath}lapiz.jpg` },
                    { name: 'Lecci√≥n', path: `${basePath}leccion.jpg` },
                    { name: 'Mapa', path: `${basePath}mapa.jpg` },
                    { name: 'Microscopio', path: `${basePath}microscopio.jpg` },
                    { name: 'Papel', path: `${basePath}papel.jpg` },
                    { name: 'P√°rrafo', path: `${basePath}parrafo.jpg` },
                    { name: 'Perspectiva', path: `${basePath}perspectiva.jpg` },
                    { name: 'Pizarr√≥n', path: `${basePath}pizarron.jpg` },
                    { name: 'Pluma', path: `${basePath}pluma.jpg` },
                    { name: 'Polit√©cnico', path: `${basePath}politecnico.jpg` },
                    { name: 'Premio', path: `${basePath}premio.jpg` },
                    { name: 'Preparatoria', path: `${basePath}preparatoria.jpg` },
                    { name: 'Primaria', path: `${basePath}primaria.jpg` },
                    { name: 'Prueba', path: `${basePath}prueba.jpg` },
                    { name: 'Qu√≠mica', path: `${basePath}quimica.jpg` },
                    { name: 'Sacapuntas', path: `${basePath}sacapuntas.jpg` },
                    { name: 'Secundaria', path: `${basePath}secundaria.jpg` },
                    { name: 'Tecnol√≥gico', path: `${basePath}tecnologico.jpg` }
                ],
                estaciones: [
                    { name: 'Primavera', path: `${basePath}primavera.jpg` },
                    { name: 'Verano', path: `${basePath}verano.jpg` },
                    { name: 'Oto√±o', path: `${basePath}oto√±o.jpg` },
                    { name: 'Invierno', path: `${basePath}invierno.jpg` }
                ],
                meses: [
                    { name: 'Enero', path: `${basePath}enero.jpg` },
                    { name: 'Febrero', path: `${basePath}febrero.jpg` },
                    { name: 'Marzo', path: `${basePath}marzo.jpg` },
                    { name: 'Abril', path: `${basePath}abril.jpg` },
                    { name: 'Mayo', path: `${basePath}mayo.jpg` },
                    { name: 'Junio', path: `${basePath}junio.jpg` },
                    { name: 'Julio', path: `${basePath}julio.jpg` },
                    { name: 'Agosto', path: `${basePath}agosto.jpg` },
                    { name: 'Septiembre', path: `${basePath}septiembre.jpg` },
                    { name: 'Octubre', path: `${basePath}octubre.jpg` },
                    { name: 'Noviembre', path: `${basePath}noviembre.jpg` },
                    { name: 'Diciembre', path: `${basePath}diciembre.jpg` }
                ],
                tiempo: [
                    { name: 'Sol', path: `${basePath}tiempo_sol.jpg` },
                    { name: 'Lluvia', path: `${basePath}tiempo_lluvia.jpg` },
                    { name: 'Nieve', path: `${basePath}tiempo_nieve.jpg` },
                    { name: 'Viento', path: `${basePath}tiempo_viento.jpg` }
                ],
                saludos: [
                    { name: 'Hola', path: `${basePath}saludo_hola.jpg` },
                    { name: 'Adi√≥s', path: `${basePath}saludo_adios.jpg` },
                    { name: 'C√≥mo est√°s', path: `${basePath}saludo_como_estas.jpg` },
                    { name: 'Comparte', path: `${basePath}saludo_comparte.jpg` },
                    { name: 'Ayuda', path: `${basePath}saludo_ayuda.jpg` },
                    { name: 'Buenos d√≠as', path: `${basePath}saludo_buenos_dias.jpg` }
                ],
                groserias: [
                    { name: 'Tonto', path: `${basePath}groseria_tonto.jpg` },
                    { name: 'G√ºey', path: `${basePath}groseria_guey.jpg` },
                    { name: 'Idiota', path: `${basePath}groseria_idiota.jpg` },
                    { name: 'Puto', path: `${basePath}groseria_puto.jpg` },
                    { name: 'Mierda', path: `${basePath}groseria_mierda.jpg` },
                    { name: 'Zorra', path: `${basePath}groseria_zorra.jpg` },
                    { name: 'Pendejo', path: `${basePath}groseria_pendejo.jpg` },
                    { name: 'Verga', path: `${basePath}groseria_verga.jpg` }
                ]
            };
            return images[folder] || [];
        }

        let currentIndex = 0;
        function initializeCarousel() {
            const carousel = document.getElementById('carousel');
            if (!carousel) return;
            const items = carousel.children.length;
            if (items === 0) return;
            currentIndex = 0;
            carousel.style.transform = `translateX(0%)`;
            console.log('[DEBUG] Carousel initialized');
        }

        function moveCarousel(direction) {
            const carousel = document.getElementById('carousel');
            if (!carousel) return;
            const items = carousel.children.length;
            if (items === 0) return;
            currentIndex = (currentIndex + direction + items) % items;
            carousel.style.transform = `translateX(-${currentIndex * 100}%)`;
            console.log('[DEBUG] Carousel moved to index: ' + currentIndex);
        }

        window.moveCarousel = moveCarousel;

        renderMainScreen();
    </script>
</body>
</html>




